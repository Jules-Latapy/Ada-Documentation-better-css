<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
    <TITLE>Asynchronous Task Control</TITLE>
    <META NAME="Author" CONTENT="JTC1/SC22/WG9/ARG, by Randall Brukardt, ARG Editor">
    <META NAME="GENERATOR" CONTENT="Arm_Form.Exe, Ada Reference Manual generator">
    <link rel="stylesheet" href="../styles.css">
    
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFF0" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">
<P class="navig"><img src="../logo.svg" class="adaLogo" /><A HREF="RM-TOC.html">Contents</A>&nbsp;&nbsp;&nbsp;<A HREF="RM-0-29.html">Index</A>&nbsp;&nbsp;&nbsp;<A HREF="../RM-SRCH.html">Search</A>&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="RM-D-10.html">Previous</A>&nbsp;&nbsp;&nbsp;<A HREF="RM-D-12.html">Next</A></P>
<div class="main">
<H1> D.11 Asynchronous Task Control</H1>
<DIV Class="Paranum"><FONT SIZE=-2>1</FONT></DIV>
<DIV Class="Normal">&nbsp;&nbsp;&nbsp;This clause introduces a language-defined package
to do asynchronous suspend/resume on tasks. It uses a conceptual <I>held
priority</I> value to represent the task's <I>held</I> state. </DIV>

<H4 ALIGN=CENTER>Static Semantics</H4>
<DIV Class="Paranum"><FONT SIZE=-2>2</FONT></DIV>
<DIV Class="Normal" Style="margin-bottom: 0.4em">&nbsp;&nbsp;&nbsp;The following language-defined
library package exists: </DIV>
<DIV Class="Paranum"><FONT SIZE=-2>3</FONT></DIV>
<DIV Class="Examples"><TT><B>with</B>&nbsp;Ada.Task_Identification;<BR>
<B>package</B>&nbsp;Ada.Asynchronous_Task_Control&nbsp;<B>is</B><A NAME="I6673"></A><A NAME="I6674"></A><A NAME="I6675"></A><BR>
&nbsp;&nbsp;<B>procedure</B>&nbsp;<A NAME="I6676"></A><A NAME="I6677"></A>Hold(T&nbsp;:&nbsp;<B>in</B>&nbsp;Ada.Task_Identification.Task_ID);<BR>
&nbsp;&nbsp;<B>procedure</B>&nbsp;<A NAME="I6678"></A><A NAME="I6679"></A>Continue(T&nbsp;:&nbsp;<B>in</B>&nbsp;Ada.Task_Identification.Task_ID);<BR>
&nbsp;&nbsp;<B>function</B>&nbsp;<A NAME="I6680"></A><A NAME="I6681"></A>Is_Held(T&nbsp;:&nbsp;Ada.Task_Identification.Task_ID)<BR>
&nbsp;&nbsp;&nbsp;<B>return</B>&nbsp;Boolean;<BR>
<B>end</B>&nbsp;Ada.Asynchronous_Task_Control;</TT></DIV>

<H4 ALIGN=CENTER>Dynamic Semantics</H4>
<DIV Class="Paranum"><FONT SIZE=-2>4</FONT></DIV>
<DIV Class="Normal">&nbsp;&nbsp;&nbsp;<A NAME="I6682"></A><A NAME="I6683"></A><A NAME="I6684"></A>After
the Hold operation has been applied to a task, the task becomes <I>held</I>.
For each processor there is a conceptual <I>idle task</I>, which is always
ready. The base priority of the idle task is below System.Any_Priority'First.
The <I>held priority</I> is a constant of the type integer whose value
is below the base priority of the idle task. </DIV>
<DIV Class="Paranum"><FONT SIZE=-2>5</FONT></DIV>
<DIV Class="Normal">&nbsp;&nbsp;&nbsp;The Hold operation sets the state of T to held.
For a held task: the task's own base priority does not constitute an
inheritance source (see <A HREF="RM-D-1.html">D.1</A>), and the value
of the held priority is defined to be such a source instead. </DIV>
<DIV Class="Paranum"><FONT SIZE=-2>6</FONT></DIV>
<DIV Class="Normal">&nbsp;&nbsp;&nbsp;The Continue operation resets the state of T to
not-held; T's active priority is then reevaluated as described in <A HREF="RM-D-1.html">D.1</A>.
This time, T's base priority is taken into account.</DIV>
<DIV Class="Paranum"><FONT SIZE=-2>7</FONT></DIV>
<DIV Class="Normal">&nbsp;&nbsp;&nbsp;The Is_Held function returns True if and only
if T is in the held state. </DIV>
<DIV Class="Paranum"><FONT SIZE=-2>8</FONT></DIV>
<DIV Class="Normal">&nbsp;&nbsp;&nbsp;As part of these operations, a check is made that
the task identified by T is not terminated. <A NAME="I6685"></A>Tasking_Error
is raised if the check fails. <A NAME="I6686"></A>Program_Error is raised
if the value of T is Null_Task_ID.</DIV>

<H4 ALIGN=CENTER>Erroneous Execution</H4>
<DIV Class="Paranum"><FONT SIZE=-2>9</FONT></DIV>
<DIV Class="Normal">&nbsp;&nbsp;&nbsp;<A NAME="I6687"></A>If any operation in this package
is called with a parameter T that specifies a task object that no longer
exists, the execution of the program is erroneous. </DIV>

<H4 ALIGN=CENTER>Implementation Permissions</H4>
<DIV Class="Paranum"><FONT SIZE=-2>10</FONT></DIV>
<DIV Class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;An implementation need not support Asynchronous_Task_Control
if it is infeasible to support it in the target environment. </DIV>
<DIV Class="NotesHeader"><FONT SIZE="-1">NOTES</FONT></DIV>
<DIV Class="Paranum"><FONT SIZE=-2>11</FONT></DIV>
<DIV Class="Notes"><FONT SIZE="-1">33&nbsp;&nbsp;It is a consequence
of the priority rules that held tasks cannot be dispatched on any processor
in a partition (unless they are inheriting priorities) since their priorities
are defined to be below the priority of any idle task.</FONT></DIV>
<DIV Class="Paranum"><FONT SIZE=-2>12</FONT></DIV>
<DIV Class="Notes"><FONT SIZE="-1">34&nbsp;&nbsp;The effect of calling
Get_Priority and Set_Priority on a Held task is the same as on any other
task.</FONT></DIV>
<DIV Class="Paranum"><FONT SIZE=-2>13</FONT></DIV>
<DIV Class="Notes"><FONT SIZE="-1">35&nbsp;&nbsp;Calling Hold on a held
task or Continue on a non-held task has no effect.</FONT></DIV>
<DIV Class="Paranum"><FONT SIZE=-2>14</FONT></DIV>
<DIV Class="Notes" Style="margin-bottom: 0.4em"><FONT SIZE="-1">36&nbsp;&nbsp;The
rules affecting queuing are derived from the above rules, in addition
to the normal priority rules: </FONT></DIV>
<DIV Class="Paranum"><FONT SIZE=-2>15</FONT></DIV>
<UL Class="NotesBulleted"><LI TYPE=DISC><FONT SIZE="-1">When a held task
is on the ready queue, its priority is so low as to never reach the top
of the queue as long as there are other tasks on that queue.</FONT></LI></UL>
<DIV Class="Paranum"><FONT SIZE=-2>16</FONT></DIV>
<UL Class="NotesBulleted"><LI TYPE=DISC><FONT SIZE="-1">If a task is
executing in a protected action, inside a rendezvous, or is inheriting
priorities from other sources (e.g. when activated), it continues to
execute until it is no longer executing the corresponding construct.</FONT></LI></UL>
<DIV Class="Paranum"><FONT SIZE=-2>17</FONT></DIV>
<UL Class="NotesBulleted"><LI TYPE=DISC><FONT SIZE="-1">If a task becomes
held while waiting (as a caller) for a rendezvous to complete, the active
priority of the accepting task is not affected.</FONT></LI></UL>
<DIV Class="Paranum"><FONT SIZE=-2>18/1</FONT></DIV>
<UL Class="NotesBulleted"><LI TYPE=DISC><FONT SIZE="-1">If a task becomes
held while waiting in a <FONT FACE="Arial, Helvetica">selective_accept</FONT>,
and an entry call is issued to one of the open entries, the corresponding
<FONT FACE="Arial, Helvetica">accept_alternative</FONT> executes. When
the rendezvous completes, the active priority of the accepting task is
lowered to the held priority (unless it is still inheriting from other
sources), and the task does not execute until another Continue.</FONT></LI></UL>
<DIV Class="Paranum"><FONT SIZE=-2>19</FONT></DIV>
<UL Class="NotesBulleted"><LI TYPE=DISC><FONT SIZE="-1">The same holds
if the held task is the only task on a protected entry queue whose barrier
becomes open. The corresponding entry body executes.</FONT></LI></UL>

</div>
<P><A HREF="RM-TOC.html">Contents</A>&nbsp;&nbsp;&nbsp;<A HREF="RM-0-29.html">Index</A>&nbsp;&nbsp;&nbsp;<A HREF="../RM-SRCH.html">Search</A>&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="RM-D-10.html">Previous</A>&nbsp;&nbsp;&nbsp;<A HREF="RM-D-12.html">Next</A>&nbsp;&nbsp;&nbsp;<A HREF="RM-TTL.html">Legal</A></P>
</BODY>
</HTML>
