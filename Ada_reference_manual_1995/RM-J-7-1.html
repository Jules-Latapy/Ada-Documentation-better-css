<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
    <TITLE>Interrupt Entries</TITLE>
    <META NAME="Author" CONTENT="JTC1/SC22/WG9/ARG, by Randall Brukardt, ARG Editor">
    <META NAME="GENERATOR" CONTENT="Arm_Form.Exe, Ada Reference Manual generator">
    <link rel="stylesheet" href="../styles.css">
    
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFF0" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">
<P class="navig"><img src="../logo.svg" class="adaLogo" /><A HREF="RM-TOC.html">Contents</A>&nbsp;&nbsp;&nbsp;<A HREF="RM-0-29.html">Index</A>&nbsp;&nbsp;&nbsp;<A HREF="../RM-SRCH.html">Search</A>&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="RM-J-7.html">Previous</A>&nbsp;&nbsp;&nbsp;<A HREF="RM-J-8.html">Next</A></P>
<div class="main">
<H1> J.7.1 Interrupt Entries</H1>
<DIV Class="Paranum"><FONT SIZE=-2>1</FONT></DIV>
<DIV Class="Normal">&nbsp;&nbsp;&nbsp;Implementations are permitted to allow the attachment
of task entries to interrupts via the address clause. Such an entry is
referred to as an <I>interrupt entry</I>.</DIV>
<DIV Class="Paranum"><FONT SIZE=-2>2</FONT></DIV>
<DIV Class="Normal">&nbsp;&nbsp;&nbsp;The address of the task entry corresponds to a
hardware interrupt in an implementation-defined manner. (See Ada.Interrupts.Reference
in <A HREF="RM-C-3-2.html">C.3.2</A>.) </DIV>

<H4 ALIGN=CENTER>Static Semantics</H4>
<DIV Class="Paranum"><FONT SIZE=-2>3</FONT></DIV>
<DIV Class="Normal" Style="margin-bottom: 0.4em">&nbsp;&nbsp;&nbsp;The following attribute
is defined:</DIV>
<DIV Class="Paranum"><FONT SIZE=-2>4</FONT></DIV>
<DIV Class="Normal" Style="margin-bottom: 0.4em">&nbsp;&nbsp;&nbsp;For any task entry
X: </DIV>
<DIV Class="Paranum"><FONT SIZE=-2>5</FONT></DIV>
<DL Class="Hanging"><DT>&nbsp;&nbsp;&nbsp;<A NAME="I7090"></A>X'<A NAME="I7091"></A><A NAME="I7092"></A>Address
<DD Class="Hanging">
For a task entry whose address is specified (an <I>interrupt entry</I>),
the value refers to the corresponding hardware interrupt. For such an
entry, as for any other task entry, the meaning of this value is implementation
defined. The value of this attribute is of the type of the subtype System.Address.</DL>
<DIV Class="Paranum"><FONT SIZE=-2>6</FONT></DIV>
<DL Class="Hanging"><DD Class ="Hanging"><A NAME="I7093"></A>Address
may be specified for single entries via an <FONT FACE="Arial, Helvetica">attribute_definition_clause</FONT>.
</DL>

<H4 ALIGN=CENTER>Dynamic Semantics</H4>
<DIV Class="Paranum"><FONT SIZE=-2>7</FONT></DIV>
<DIV Class="Normal">&nbsp;&nbsp;&nbsp;<A NAME="I7094"></A>As part of the initialization
of a task object, the address clause for an interrupt entry is elaborated,
which evaluates the <FONT FACE="Arial, Helvetica">expression</FONT> of
the address clause. A check is made that the address specified is associated
with some interrupt to which a task entry may be attached. <A NAME="I7095"></A>If
this check fails, Program_Error is raised. Otherwise, the interrupt entry
is attached to the interrupt associated with the specified address.</DIV>
<DIV Class="Paranum"><FONT SIZE=-2>8</FONT></DIV>
<DIV Class="Normal">&nbsp;&nbsp;&nbsp;<A NAME="I7096"></A>Upon finalization of the task
object, the interrupt entry, if any, is detached from the corresponding
interrupt and the default treatment is restored.</DIV>
<DIV Class="Paranum"><FONT SIZE=-2>9</FONT></DIV>
<DIV Class="Normal">&nbsp;&nbsp;&nbsp;While an interrupt entry is attached to an interrupt,
the interrupt is reserved (see <A HREF="RM-C-3.html">C.3</A>).</DIV>
<DIV Class="Paranum"><FONT SIZE=-2>10</FONT></DIV>
<DIV Class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;An interrupt delivered to a task entry acts as
a call to the entry issued by a hardware task whose priority is in the
System.Interrupt_Priority range. It is implementation defined whether
the call is performed as an ordinary entry call, a timed entry call,
or a conditional entry call; which kind of call is performed can depend
on the specific interrupt.</DIV>

<H4 ALIGN=CENTER>Bounded (Run-Time) Errors</H4>
<DIV Class="Paranum"><FONT SIZE=-2>11</FONT></DIV>
<DIV Class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;<A NAME="I7097"></A>It is a bounded error to
evaluate E'Caller (see <A HREF="RM-C-7-1.html">C.7.1</A>) in an <FONT FACE="Arial, Helvetica">accept_statement</FONT>
for an interrupt entry. The possible effects are the same as for calling
Current_Task from an entry body. </DIV>

<H4 ALIGN=CENTER>Documentation Requirements</H4>
<DIV Class="Paranum"><FONT SIZE=-2>12</FONT></DIV>
<DIV Class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;The implementation shall document to which interrupts
a task entry may be attached.</DIV>
<DIV Class="Paranum"><FONT SIZE=-2>13</FONT></DIV>
<DIV Class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;The implementation shall document whether the
invocation of an interrupt entry has the effect of an ordinary entry
call, conditional call, or a timed call, and whether the effect varies
in the presence of pending interrupts.</DIV>

<H4 ALIGN=CENTER>Implementation Permissions</H4>
<DIV Class="Paranum"><FONT SIZE=-2>14</FONT></DIV>
<DIV Class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;The support for this subclause is optional.</DIV>
<DIV Class="Paranum"><FONT SIZE=-2>15</FONT></DIV>
<DIV Class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;Interrupts to which the implementation allows
a task entry to be attached may be designated as reserved for the entire
duration of program execution; that is, not just when they have an interrupt
entry attached to them.</DIV>
<DIV Class="Paranum"><FONT SIZE=-2>16/1</FONT></DIV>
<DIV Class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Interrupt entry calls may be implemented by
having the hardware execute directly the appropriate <FONT FACE="Arial, Helvetica">accept_statement</FONT>.
Alternatively, the implementation is allowed to provide an internal interrupt
handler to simulate the effect of a normal task calling the entry.</DIV>
<DIV Class="Paranum"><FONT SIZE=-2>17</FONT></DIV>
<DIV Class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;The implementation is allowed to impose restrictions
on the specifications and bodies of tasks that have interrupt entries.</DIV>
<DIV Class="Paranum"><FONT SIZE=-2>18</FONT></DIV>
<DIV Class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;It is implementation defined whether direct calls
(from the program) to interrupt entries are allowed.</DIV>
<DIV Class="Paranum"><FONT SIZE=-2>19</FONT></DIV>
<DIV Class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;If a <FONT FACE="Arial, Helvetica">select_statement</FONT>
contains both a <FONT FACE="Arial, Helvetica">terminate_alternative</FONT>
and an <FONT FACE="Arial, Helvetica">accept_alternative</FONT> for an
interrupt entry, then an implementation is allowed to impose further
requirements for the selection of the <FONT FACE="Arial, Helvetica">terminate_alternative</FONT>
in addition to those given in <A HREF="RM-9-3.html">9.3</A>. </DIV>
<DIV Class="NotesHeader"><FONT SIZE="-1">NOTES</FONT></DIV>
<DIV Class="Paranum"><FONT SIZE=-2>20/1</FONT></DIV>
<DIV Class="Notes"><FONT SIZE="-1">1&nbsp;&nbsp;Queued interrupts correspond
to ordinary entry calls. Interrupts that are lost if not immediately
processed correspond to conditional entry calls. It is a consequence
of the priority rules that an <FONT FACE="Arial, Helvetica">accept_statement</FONT>
executed in response to an interrupt can be executed with the active
priority at which the hardware generates the interrupt, taking precedence
over lower priority tasks, without a scheduling action.</FONT></DIV>
<DIV Class="Paranum"><FONT SIZE=-2>21</FONT></DIV>
<DIV Class="Notes"><FONT SIZE="-1">2&nbsp;&nbsp;Control information that
is supplied upon an interrupt can be passed to an associated interrupt
entry as one or more parameters of mode <B>in</B>. </FONT></DIV>

<H4 ALIGN=CENTER>Examples</H4>
<DIV Class="Paranum"><FONT SIZE=-2>22</FONT></DIV>
<DIV Class="Normal" Style="margin-bottom: 0.4em">&nbsp;&nbsp;&nbsp;&nbsp;<I>Example of an
interrupt entry:</I> </DIV>
<DIV Class="Paranum"><FONT SIZE=-2>23</FONT></DIV>
<DIV Class="Examples"><TT><B>task</B>&nbsp;Interrupt_Handler&nbsp;<B>is</B><BR>
&nbsp;&nbsp;<B>entry</B>&nbsp;Done;<BR>
&nbsp;&nbsp;<B>for</B>&nbsp;Done'Address&nbsp;<B>use</B>&nbsp;Ada.Interrupts.Reference(Ada.Interrupts.Names.Device_Done);<BR>
<B>end</B>&nbsp;Interrupt_Handler;</TT></DIV>

</div>
<P><A HREF="RM-TOC.html">Contents</A>&nbsp;&nbsp;&nbsp;<A HREF="RM-0-29.html">Index</A>&nbsp;&nbsp;&nbsp;<A HREF="../RM-SRCH.html">Search</A>&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="RM-J-7.html">Previous</A>&nbsp;&nbsp;&nbsp;<A HREF="RM-J-8.html">Next</A>&nbsp;&nbsp;&nbsp;<A HREF="RM-TTL.html">Legal</A></P>
</BODY>
</HTML>
